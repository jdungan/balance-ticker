var DateUtil, ExtMath, Summary, build, height, line, parseDate, sparkline, width, x, y,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

ExtMath = (function(_super) {
  __extends(ExtMath, _super);

  function ExtMath() {
    return ExtMath.__super__.constructor.apply(this, arguments);
  }

  ExtMath.truncate = function(x, precision) {
    var scale, scales;
    if (precision == null) {
      precision = 0;
    }
    scales = [1, 10, 100, 1000, 10000, 100000, 1000000, 10000000, 100000000];
    scale = scales[precision];
    return Math.round(x * scale) / scale;
  };

  return ExtMath;

})(Math);

width = 96;

height = 64;

x = d3.scale.linear().range([0, width - 2]);

y = d3.scale.linear().range([height - 4, 0]);

parseDate = d3.time.format("%Y-%m-%d").parse;

line = d3.svg.line().interpolate("basis").x(function(d) {
  return x(d[0]);
}).y(function(d) {
  return y(d[1]);
});

sparkline = function(g, data) {
  if (data.length > 0) {
    g.append('path').datum(data).classed('sparkline', true).attr('d', line);
    return g.append('circle').classed('sparkcircle', true).attr('cx', function() {
      return x(_.last(data)[0]);
    }).attr('cy', function() {
      return y(_.last(data)[1]);
    }).attr('r', 1.5);
  }
};

DateUtil = function(JSdate, type) {
  if (JSdate) {
    switch (type) {
      case "M/D":
        return (JSdate.getMonth() + 1) + "/" + JSdate.getDate();
    }
  }
};

Summary = (function() {
  function Summary() {
    this.name = "";
    this.calls = [];
    this.dates = [];
  }

  Summary.prototype.sum = function() {
    if (this.calls.length > 0) {
      return _.reduce(this.calls, function(memo, num) {
        return memo + num;
      });
    } else {
      return 0;
    }
  };

  Summary.prototype.max = function() {
    return _.reduce(this.calls, function(m, n) {
      if (n > m) {
        return n;
      } else {
        return m;
      }
    });
  };

  Summary.prototype.min = function() {
    return _.reduce(this.calls, function(m, n) {
      if (n < m) {
        return n;
      } else {
        return m;
      }
    });
  };

  Summary.prototype.avg = function() {
    return ExtMath.truncate(this.sum() / this.calls.length, 1);
  };

  Summary.prototype.add = function(points) {
    var iter;
    iter = function(e, i, l) {
      var date, date_pos, _ref;
      date_pos = _.sortedIndex(this.dates, e[0]);
      date = (_ref = this.dates[date_pos]) != null ? _ref : 0;
      if (e[0].valueOf() !== date.valueOf()) {
        this.dates = _.first(this.dates, date_pos).concat([e[0]], _.rest(this.dates, date_pos));
        this.calls = _.first(this.calls, date_pos).concat([0], _.rest(this.calls, date_pos));
      }
      return this.calls[date_pos] += e[1];
    };
    return _.each(points, iter, this);
  };

  Summary.prototype.points = function() {
    return _.zip(this.dates, this.calls);
  };

  return Summary;

})();

build = function(data) {
  var display, media_li, total_calls;
  console.log(data);
  total_calls = new Summary;
  total_calls.name = "ALL";
  display = _.map(data.contents.data, function(v, i, l) {
    var calls, dates, this_state;
    dates = _.map(v.x, function(v, i, l) {
      return parseDate(v);
    });
    calls = _.map(v.y, function(v, i, l) {
      var _name;
      return v - (l[_name = i - 1] != null ? l[_name] : l[_name] = 0);
    });
    this_state = new Summary;
    this_state.name = v.name;
    this_state.add(_.zip(dates, calls));
    total_calls.add(this_state.points());
    return this_state;
  });
  display.unshift(total_calls);
  media_li = d3.select('#programs').selectAll('li').data(display).enter().append("li").classed("list-group-item", true).append("div").classed("media", true);
  return media_li.each(function(d, i) {
    var body, media, svg;
    x.domain(d3.extent(d.dates));
    y.domain(d3.extent(d.calls));
    media = d3.select(this);
    svg = media.append("div").classed("pull-left", true).append('svg').classed("media-object", true).attr('width', width).attr('height', height).append('g').attr('transform', 'translate(0, 2)');
    sparkline(svg, d.points());
    body = media.append('div').classed("media-body", true);
    body.append('h4').classed("media-heading", true).text(function(d, i) {
      return d.name;
    });
    body.append('p').text(function(d, i) {
      var lastdate;
      lastdate = _.last(d.dates);
      return "There have been " + d.sum() + " balance checks by the end of " + DateUtil(lastdate, "M/D");
    });
    body.append('p').text(function(d, i) {
      return "The average checks per day is " + d.avg();
    });
    return body.append('p').text(function(d, i) {
      var diff, lastcalls, lastdates, sentence;
      lastcalls = _.last(d.calls, 2);
      lastdates = _.last(d.dates, 2);
      diff = lastcalls[1] - lastcalls[0];
      sentence = ["", "", "", "on", "", "than on", ""];
      sentence[0] = (Math.abs(diff)) === 1 ? "There was" : "There were";
      sentence[1] = Math.abs(diff);
      sentence[2] = diff > 0 ? "more" : "fewer";
      sentence[4] = DateUtil(lastdates[1], "M/D");
      sentence[6] = DateUtil(lastdates[0], "M/D");
      return sentence.join(" ");
    });
  });
};

$(document).ready(function() {
  var data_url;
  data_url = 'http://whateverorigin.org/get?url=' + encodeURIComponent('https://plot.ly/~lippytak/184/balance-metrics-checks.json') + '&callback=?';
  return $.getJSON(data_url, build);
});

//# sourceMappingURL=data:application/json;base64,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QUFBLENBQXRCLEVBN0JJO0VBQUEsQ0FEUixFQTNCSTtBQUFBLENBakVSLENBQUE7O0FBQUEsQ0FzSUEsQ0FBRSxRQUFGLENBQVcsQ0FBQyxLQUFaLENBQWtCLFNBQUEsR0FBQTtBQUNoQixNQUFBLFFBQUE7QUFBQSxFQUFBLFFBQUEsR0FBVSxvQ0FBQSxHQUF1QyxrQkFBQSxDQUFtQiwyREFBbkIsQ0FBdkMsR0FBeUgsYUFBbkksQ0FBQTtTQUNBLENBQUMsQ0FBQyxPQUFGLENBQVUsUUFBVixFQUFvQixLQUFwQixFQUZnQjtBQUFBLENBQWxCLENBdElBLENBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiIyBjb3BpZWQgZnJvbSBodHRwOi8vd3d3LmNhbGljb3dlYmRldi5jb20vMjAxMS8wNS8wMS9zaW1wbGUtY29mZmVlc2NyaXB0LWludHJvZHVjdGlvbi9cbmNsYXNzIEV4dE1hdGggZXh0ZW5kcyBNYXRoXG4gIEB0cnVuY2F0ZSA9ICh4LCBwcmVjaXNpb24gPSAwKSAtPlxuICAgIHNjYWxlcyA9IFsxLCAxMCwgMTAwLCAxMDAwLCAxMDAwMCwgMTAwMDAwLCAxMDAwMDAwLCAxMDAwMDAwMCwgMTAwMDAwMDAwXVxuICAgIHNjYWxlID0gc2NhbGVzW3ByZWNpc2lvbl1cbiAgICBNYXRoLnJvdW5kKHggKiBzY2FsZSkgLyBzY2FsZVxuXG4jIHNwYXJrbGluZSBhZGFwdGVkIGZyb20gaHR0cDovL3d3dy50bm9kYS5jb20vYmxvZy8yMDEzLTEyLTE5XG53aWR0aCA9IDk2XG5oZWlnaHQgPSA2NFxueCA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFswLCB3aWR0aCAtIDJdKVxueSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFtoZWlnaHQgLSA0LCAwXSlcbnBhcnNlRGF0ZSA9IGQzLnRpbWUuZm9ybWF0KFwiJVktJW0tJWRcIikucGFyc2VcblxubGluZSA9IGQzLnN2Zy5saW5lKClcbiAgLmludGVycG9sYXRlKFwiYmFzaXNcIilcbiAgLngoIChkKSAtPiB4KCBkWzBdICkgKVxuICAueSggKGQpIC0+IHkoIGRbMV0gKSApXG5cbnNwYXJrbGluZSA9IChnLCBkYXRhKSAtPlxuICBcbiAgaWYgZGF0YS5sZW5ndGggPiAwXG4gICAgZy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgLmRhdHVtKGRhdGEpXG4gICAgICAuY2xhc3NlZCgnc3BhcmtsaW5lJyx0cnVlKVxuICAgICAgLmF0dHIoJ2QnLCBsaW5lKVxuXG4gICAgZy5hcHBlbmQoJ2NpcmNsZScpXG4gICAgICAuY2xhc3NlZCgnc3BhcmtjaXJjbGUnLHRydWUpXG4gICAgICAuYXR0cignY3gnLCAtPiB4KCBfLmxhc3QoZGF0YSlbMF0gKSApXG4gICAgICAuYXR0cignY3knLCAtPiB5KCBfLmxhc3QoZGF0YSlbMV0gKSApXG4gICAgICAuYXR0cigncicsIDEuNSlcblxuRGF0ZVV0aWwgPSAoSlNkYXRlLHR5cGUpLT5cbiAgaWYgSlNkYXRlXG4gICAgc3dpdGNoIHR5cGVcbiAgICAgIHdoZW4gXCJNL0RcIiB0aGVuIChKU2RhdGUuZ2V0TW9udGgoKSArIDEpICsgXCIvXCIgKyBKU2RhdGUuZ2V0RGF0ZSgpXG5cbmNsYXNzIFN1bW1hcnlcbiAgY29uc3RydWN0b3I6LT5cbiAgICBAbmFtZSA9XCJcIiAgXG4gICAgQGNhbGxzPVtdXG4gICAgQGRhdGVzPVtdXG4gIHN1bSA6IC0+XG4gICAgaWYgQGNhbGxzLmxlbmd0aCA+IDBcbiAgICAgIF8ucmVkdWNlIEBjYWxscywobWVtbywgbnVtKSAtPiBtZW1vICsgbnVtXG4gICAgZWxzZVxuICAgICAgMFxuICBtYXggOiAtPiBfLnJlZHVjZSBAY2FsbHMsKG0sbiktPiBpZiBuPm0gdGhlbiBuIGVsc2UgbVxuICBtaW4gOiAtPiBfLnJlZHVjZSBAY2FsbHMsKG0sbiktPiBpZiBuPG0gdGhlbiBuIGVsc2UgbVxuICBhdmcgOiAtPiBFeHRNYXRoLnRydW5jYXRlIEBzdW0oKSAvIEBjYWxscy5sZW5ndGgsMVxuICAgIFxuICBhZGQ6IChwb2ludHMpLT5cbiAgICBpdGVyID0gKGUsaSxsKS0+XG4gICAgICBkYXRlX3BvcyA9IF8uc29ydGVkSW5kZXgoQGRhdGVzLGVbMF0pXG4gICAgICBkYXRlID0gQGRhdGVzW2RhdGVfcG9zXSA/IDBcbiAgICAgIGlmIGVbMF0udmFsdWVPZigpIGlzbnQgZGF0ZS52YWx1ZU9mKClcbiAgICAgICAgQGRhdGVzPSBfLmZpcnN0KEBkYXRlcyxkYXRlX3BvcykuY29uY2F0ICBbZVswXV0gLCBfLnJlc3QoQGRhdGVzLGRhdGVfcG9zKVxuICAgICAgICBAY2FsbHM9IF8uZmlyc3QoQGNhbGxzLGRhdGVfcG9zKS5jb25jYXQgIFswXSAsIF8ucmVzdChAY2FsbHMsZGF0ZV9wb3MpXG4gICAgICBAY2FsbHNbZGF0ZV9wb3NdICArPSBlWzFdXG4gICAgXy5lYWNoIHBvaW50cyxpdGVyLEBcbiAgcG9pbnRzOiAtPlxuICAgIF8uemlwIEBkYXRlcyxAY2FsbHNcblxuXG5cbmJ1aWxkID0gKGRhdGEpLT5cbiAgICBjb25zb2xlLmxvZyhkYXRhKVxuICAgIHRvdGFsX2NhbGxzPSBuZXcgU3VtbWFyeSAgICAgICAgXG4gICAgdG90YWxfY2FsbHMubmFtZSA9XCJBTExcIlxuICAgIFxuICAgIGRpc3BsYXkgPSBfLm1hcChkYXRhLmNvbnRlbnRzLmRhdGEsXG4gICAgICAodixpLGwpLT5cbiAgICAgICAgZGF0ZXMgPSBfLm1hcCh2LngsICh2LGksbCkgLT4gcGFyc2VEYXRlIHYgKSBcbiAgICAgICAgY2FsbHMgPSBfLm1hcCh2LnksICh2LGksbCkgLT4gdi1sW2ktMV0/PTAgKSAgXG4gICAgICAgIHRoaXNfc3RhdGUgPSBuZXcgU3VtbWFyeVxuICAgICAgICB0aGlzX3N0YXRlLm5hbWUgPSB2Lm5hbWVcbiAgICAgICAgdGhpc19zdGF0ZS5hZGQoXy56aXAoZGF0ZXMsY2FsbHMpKSAgICAgICAgICAgICAgXG4gICAgICAgIHRvdGFsX2NhbGxzLmFkZCB0aGlzX3N0YXRlLnBvaW50cygpXG4gICAgICAgIHRoaXNfc3RhdGVcbiAgICApXG4gICAgXG4gICAgZGlzcGxheS51bnNoaWZ0IHRvdGFsX2NhbGxzXG4gICAgXG4gICAgbWVkaWFfbGkgPSBkMy5zZWxlY3QoJyNwcm9ncmFtcycpXG4gICAgICAuc2VsZWN0QWxsKCdsaScpXG4gICAgICAuZGF0YShkaXNwbGF5KVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaVwiKVxuICAgICAgICAuY2xhc3NlZChcImxpc3QtZ3JvdXAtaXRlbVwiLHRydWUpXG4gICAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgIC5jbGFzc2VkKFwibWVkaWFcIix0cnVlKVxuXG4gICAgbWVkaWFfbGkgXG4gICAgICAuZWFjaCAoZCxpKS0+XG5cbiAgICAgICAgeC5kb21haW4gZDMuZXh0ZW50IGQuZGF0ZXMgXG4gICAgICAgIHkuZG9tYWluIGQzLmV4dGVudCBkLmNhbGxzICBcblxuICAgICAgICBtZWRpYSA9IGQzLnNlbGVjdCBAXG5cbiAgICAgICAgc3ZnID0gbWVkaWEuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAgICAgLmNsYXNzZWQoXCJwdWxsLWxlZnRcIix0cnVlKVxuICAgICAgICAgIC5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAuY2xhc3NlZChcIm1lZGlhLW9iamVjdFwiLHRydWUpXG4gICAgICAgICAgICAuYXR0cignd2lkdGgnLCB3aWR0aClcbiAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpXG4gICAgICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoMCwgMiknKTtcblxuICAgICAgICBzcGFya2xpbmUgc3ZnLCBkLnBvaW50cygpXG4gICAgICAgIFxuICAgICAgICBib2R5ID0gbWVkaWEgLmFwcGVuZCgnZGl2JylcbiAgICAgICAgICAuY2xhc3NlZChcIm1lZGlhLWJvZHlcIix0cnVlKVxuICAgICAgICBib2R5LmFwcGVuZCgnaDQnKVxuICAgICAgICAgIC5jbGFzc2VkKFwibWVkaWEtaGVhZGluZ1wiLHRydWUpXG4gICAgICAgICAgLnRleHQgKGQsaSktPmQubmFtZVxuICAgICAgICBib2R5LmFwcGVuZCgncCcpXG4gICAgICAgICAgLnRleHQgKGQsaSktPiBcbiAgICAgICAgICAgIGxhc3RkYXRlPV8ubGFzdChkLmRhdGVzKVxuICAgICAgICAgICAgXCJUaGVyZSBoYXZlIGJlZW4gXCIgKyBkLnN1bSgpICsgXCIgYmFsYW5jZSBjaGVja3MgYnkgdGhlIGVuZCBvZiBcIiArIERhdGVVdGlsKGxhc3RkYXRlLFwiTS9EXCIpXG4gICAgICAgIGJvZHkuYXBwZW5kKCdwJylcbiAgICAgICAgICAudGV4dCAoZCxpKS0+IFwiVGhlIGF2ZXJhZ2UgY2hlY2tzIHBlciBkYXkgaXMgXCIgKyAgZC5hdmcoKVxuICAgICAgICBib2R5LmFwcGVuZCgncCcpLnRleHQgKGQsaSktPlxuICAgICAgICAgICAgbGFzdGNhbGxzID0gXy5sYXN0KGQuY2FsbHMsMilcbiAgICAgICAgICAgIGxhc3RkYXRlcyA9IF8ubGFzdChkLmRhdGVzLDIpXG4gICAgICAgICAgICBkaWZmPSBsYXN0Y2FsbHNbMV0gLSBsYXN0Y2FsbHNbMF1cbiAgICAgICAgICAgIHNlbnRlbmNlID0gW1wiXCIsXCJcIixcIlwiLFwib25cIixcIlwiLFwidGhhbiBvblwiLFwiXCJdXG4gICAgICAgICAgICBzZW50ZW5jZVswXSA9IGlmIChNYXRoLmFicyBkaWZmKSBpcyAxIHRoZW4gXCJUaGVyZSB3YXNcIiBlbHNlIFwiVGhlcmUgd2VyZVwiXG4gICAgICAgICAgICBzZW50ZW5jZVsxXSA9IE1hdGguYWJzIGRpZmZcbiAgICAgICAgICAgIHNlbnRlbmNlWzJdID0gaWYgZGlmZiA+IDAgdGhlbiBcIm1vcmVcIiBlbHNlIFwiZmV3ZXJcIiBcbiAgICAgICAgICAgIHNlbnRlbmNlWzRdID0gRGF0ZVV0aWwgbGFzdGRhdGVzWzFdLFwiTS9EXCJcbiAgICAgICAgICAgIHNlbnRlbmNlWzZdID0gRGF0ZVV0aWwgbGFzdGRhdGVzWzBdLFwiTS9EXCJcbiAgICAgICAgICAgIHNlbnRlbmNlLmpvaW4gXCIgXCJcbiAgICAgICAgICAgIFxuJChkb2N1bWVudCkucmVhZHkgLT5cbiAgZGF0YV91cmwgPSdodHRwOi8vd2hhdGV2ZXJvcmlnaW4ub3JnL2dldD91cmw9JyArIGVuY29kZVVSSUNvbXBvbmVudCgnaHR0cHM6Ly9wbG90Lmx5L35saXBweXRhay8xODQvYmFsYW5jZS1tZXRyaWNzLWNoZWNrcy5qc29uJykgKyAnJmNhbGxiYWNrPT8nIFxuICAkLmdldEpTT04gZGF0YV91cmwgLGJ1aWxkXG5cbiJdfQ==